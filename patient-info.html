<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Parkinson's Disease Prediction System</title>
  <!-- Libraries -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
  <style>
    /* [Your existing CSS remains unchanged - kept as is for brevity] */
    :root {
      --primary: #6a11cb;
      --secondary: #2575fc;
      --danger: #ff4c4c;
      --success: #4caf50;
      --warning: #ff9800;
      --dark: #333;
      --light: #f8f9fa;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to right, var(--primary), var(--secondary));
      color: #fff;
      line-height: 1.6;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 30px;
      background: rgba(0, 0, 0, 0.2);
      backdrop-filter: blur(10px);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    .logo {
      font-size: 24px;
      font-weight: bold;
    }
    
    .nav-links {
      display: flex;
      gap: 20px;
    }
    
    .nav-links a {
      color: white;
      text-decoration: none;
      padding: 8px 15px;
      border-radius: 5px;
      transition: background 0.3s;
      cursor: pointer;
    }
    
    .nav-links a:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    .auth-buttons button {
      padding: 8px 15px;
      border-radius: 5px;
      border: none;
      cursor: pointer;
      margin-left: 10px;
    }
    
    .login-btn {
      background: transparent;
      color: white;
      border: 1px solid white;
    }
    
    .signup-btn {
      background: white;
      color: var(--primary);
    }
    
    .dashboard {
      display: grid;
      grid-template-columns: 250px 1fr;
      gap: 20px;
      margin-top: 20px;
    }
    
    .sidebar {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border-radius: 10px;
      padding: 20px;
      height: fit-content;
    }
    
    .sidebar-menu {
      list-style: none;
    }
    
    .sidebar-menu li {
      margin-bottom: 10px;
    }
    
    .sidebar-menu a {
      color: white;
      text-decoration: none;
      display: block;
      padding: 10px;
      border-radius: 5px;
      transition: background 0.3s;
      cursor: pointer;
    }
    
    .sidebar-menu a:hover, .sidebar-menu a.active {
      background: rgba(255, 255, 255, 0.3);
    }
    
    .sidebar-menu i {
      margin-right: 10px;
      width: 20px;
      text-align: center;
    }
    
    .main-content {
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border-radius: 10px;
      padding: 20px;
    }
    
    .card {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .card-title {
      font-size: 18px;
      font-weight: bold;
    }
    
    #diseaseMap {
      height: 400px;
      width: 100%;
      border-radius: 8px;
    }
    
    .chart-container {
      position: relative;
      height: 300px;
      width: 100%;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }
    
    input, select, textarea {
      width: 100%;
      padding: 10px;
      border: none;
      border-radius: 5px;
      background: rgba(255, 255, 255, 0.2);
      color: white;
    }
    
    input::placeholder {
      color: rgba(255, 255, 255, 0.7);
    }
    
    button {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      background: var(--primary);
      color: white;
      cursor: pointer;
      transition: background 0.3s;
    }
    
    button:hover {
      background: var(--secondary);
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 8px;
      overflow: hidden;
    }
    
    th, td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    th {
      background: rgba(255, 255, 255, 0.2);
      font-weight: bold;
    }
    
    tr:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .tabs {
      display: flex;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      margin-bottom: 20px;
    }
    
    .tab {
      padding: 10px 20px;
      cursor: pointer;
      border-bottom: 3px solid transparent;
    }
    
    .tab.active {
      border-bottom: 3px solid white;
      font-weight: bold;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .flex {
      display: flex;
    }
    
    .justify-between {
      justify-content: space-between;
    }
    
    .items-center {
      align-items: center;
    }
    
    .gap-4 {
      gap: 1rem;
    }
    
    .mt-4 {
      margin-top: 1rem;
    }
    
    .mb-4 {
      margin-bottom: 1rem;
    }
    
    .text-center {
      text-align: center;
    }
    
    .text-danger {
      color: var(--danger);
    }
    
    .text-success {
      color: var(--success);
    }
    
    .bg-danger {
      background: var(--danger);
    }
    
    .bg-success {
      background: var(--success);
    }
    
    .audio-recorder {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      border: 2px dashed rgba(255, 255, 255, 0.3);
      border-radius: 10px;
      margin-bottom: 20px;
    }
    
    .recorder-controls {
      display: flex;
      gap: 15px;
      margin-top: 15px;
    }
    
    .recorder-btn {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    
    .record-btn {
      background: var(--danger);
    }
    
    .stop-btn {
      background: var(--dark);
    }
    
    .upload-btn {
      background: var(--secondary);
    }
    
    @media (max-width: 768px) {
      .dashboard {
        grid-template-columns: 1fr;
      }
      
      .navbar {
        flex-direction: column;
        gap: 15px;
      }
      
      .nav-links {
        flex-direction: column;
        gap: 10px;
      }
      
      .auth-buttons {
        margin-top: 10px;
      }
    }

    /* New About Section Styling */
    #aboutParkinsonSection {
      display: none;
      padding: 20px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar">
    <div class="logo">Parkinson's Predict</div>
    <div class="nav-links">
      <a data-section="dashboard"><i class="fas fa-home"></i> Dashboard</a>
      <a data-section="analytics"><i class="fas fa-chart-line"></i> Analytics</a>
      <a data-section="history"><i class="fas fa-history"></i> History</a>
      <a data-section="globalData"><i class="fas fa-map-marked-alt"></i> Global Data</a>
      <a data-section="settings"><i class="fas fa-cog"></i> Settings</a>
      <a data-section="aboutParkinson"><i class="fas fa-info-circle"></i> About Parkinson</a>
    </div>
    <div class="auth-buttons">
      <button class="login-btn">Login</button>
      <button class="signup-btn">Sign Up</button>
    </div>
  </nav>

  <div class="container">
    <!-- Dashboard Layout -->
    <div class="dashboard">
      <!-- Sidebar -->
      <div class="sidebar">
        <ul class="sidebar-menu">
          <li><a data-section="dashboard" class="active"><i class="fas fa-tachometer-alt"></i> Overview</a></li>
          <li><a data-section="voiceAnalysis"><i class="fas fa-microphone"></i> Voice Analysis</a></li>
          <li><a data-section="riskAssessment"><i class="fas fa-chart-pie"></i> Risk Assessment</a></li>
          <li><a data-section="globalData"><i class="fas fa-globe-americas"></i> Global Data</a></li>
          <li><a data-section="patients"><i class="fas fa-user-friends"></i> Patients</a></li>
          <li><a data-section="reports"><i class="fas fa-file-export"></i> Reports</a></li>
          <li><a data-section="settings"><i class="fas fa-cog"></i> Settings</a></li>
        </ul>
      </div>

      <!-- Main Content -->
      <div class="main-content">
        <div id="dashboardSection">
          <h1>Dashboard</h1>
          
          <!-- Global Disease Occurrence Map -->
          <div class="card">
            <div class="card-header">
              <div class="card-title"><i class="fas fa-map-marked-alt"></i> Global Parkinson's Occurrence</div>
              <select id="mapTimeFilter">
                <option>Last 12 Months</option>
                <option>Last 5 Years</option>
                <option>All Time</option>
              </select>
            </div>
            <div id="diseaseMap"></div>
          </div>
          
          <!-- Stats Cards -->
          <div class="flex gap-4 mb-4">
            <div class="card" style="flex: 1;">
              <div class="card-title">Total Predictions</div>
              <div class="text-center" style="font-size: 32px; font-weight: bold;">1,248</div>
            </div>
            <div class="card" style="flex: 1;">
              <div class="card-title">Positive Cases</div>
              <div class="text-center text-danger" style="font-size: 32px; font-weight: bold;">312</div>
            </div>
            <div class="card" style="flex: 1;">
              <div class="card-title">Negative Cases</div>
              <div class="text-center text-success" style="font-size: 32px; font-weight: bold;">936</div>
            </div>
            <div class="card" style="flex: 1;">
              <div class="card-title">Average Age</div>
              <div class="text-center" style="font-size: 32px; font-weight: bold;">62.4</div>
            </div>
          </div>
          
          <!-- Age-Based Risk Graph -->
          <div class="card">
            <div class="card-header">
              <div class="card-title"><i class="fas fa-chart-bar"></i> Age-Based Risk Assessment</div>
              <select id="ageRiskFilter">
                <option>All Data</option>
                <option>Positive Cases</option>
                <option>Negative Cases</option>
              </select>
            </div>
            <div class="chart-container">
              <canvas id="ageRiskChart"></canvas>
            </div>
          </div>
          
          <!-- Tabs for Prediction and Voice Analysis -->
          <div class="card">
            <div class="tabs">
              <div class="tab active" onclick="switchTab('prediction')">New Prediction</div>
              <div class="tab" onclick="switchTab('voiceAnalysis')">Voice Analysis</div>
              <div class="tab" onclick="switchTab('comparison')">Comparative Analysis</div>
            </div>
            
            <!-- Prediction Tab -->
            <div id="predictionTab" class="tab-content active">
              <form id="predictionForm">
                <div class="form-group">
                  <label for="patientName">Patient Name</label>
                  <input type="text" id="patientName" placeholder="Enter patient name" required>
                </div>
                
                <div class="form-group">
                  <label for="patientAge">Age</label>
                  <input type="number" id="patientAge" placeholder="Enter age" min="0" required>
                </div>
                
                <div class="form-group">
                  <label for="patientLocation">Location (Country)</label>
                  <input type="text" id="patientLocation" placeholder="Enter country" required>
                </div>
                
                <h3 class="mt-4 mb-2">Voice Features</h3>
                
                <div class="flex gap-4">
                  <div style="flex: 1;">
                    <div class="form-group">
                      <label for="fo">MDVP: Fo (Hz)</label>
                      <input type="number" step="0.01" id="fo" placeholder="Average vocal frequency" required>
                    </div>
                    
                    <div class="form-group">
                      <label for="jitter">Jitter (%)</label>
                      <input type="number" step="0.01" id="jitter" placeholder="Frequency variations" required>
                    </div>
                    
                    <div class="form-group">
                      <label for="shimmer">Shimmer (dB)</label>
                      <input type="number" step="0.01" id="shimmer" placeholder="Amplitude variations" required>
                    </div>
                  </div>
                  
                  <div style="flex: 1;">
                    <div class="form-group">
                      <label for="nhr">NHR</label>
                      <input type="number" step="0.01" id="nhr" placeholder="Noise-to-harmonics ratio" required>
                    </div>
                    
                    <div class="form-group">
                      <label for="hnr">HNR</label>
                      <input type="number" step="0.01" id="hnr" placeholder="Harmonics-to-noise ratio" required>
                    </div>
                    
                    <div class="form-group">
                      <label for="ppe">PPE</label>
                      <input type="number" step="0.01" id="ppe" placeholder="Pitch period entropy" required>
                    </div>
                  </div>
                </div>
                
                <button type="submit" class="mt-3">Predict Parkinson's Risk</button>
              </form>
              <div id="predictionResult" class="mt-4" style="display: none;"></div>
            </div>
            
            <!-- Voice Analysis Tab -->
            <div id="voiceAnalysisTab" class="tab-content">
              <div class="audio-recorder">
                <i class="fas fa-microphone" style="font-size: 48px; margin-bottom: 15px;"></i>
                <p>Record your voice or upload a WAV file for analysis</p>
                
                <div class="recorder-controls">
                  <div class="recorder-btn record-btn" title="Record">
                    <i class="fas fa-microphone"></i>
                  </div>
                  <div class="recorder-btn stop-btn" title="Stop" disabled>
                    <i class="fas fa-stop"></i>
                  </div>
                  <div class="recorder-btn upload-btn" title="Upload File">
                    <i class="fas fa-upload"></i>
                  </div>
                </div>
                
                <div class="mt-3" id="audioVisualizer" style="width: 100%; height: 100px; background: rgba(255,255,255,0.1); border-radius: 5px;"></div>
              </div>
              
              <div id="extractedFeatures" style="display: none;">
                <h3>Extracted Voice Features</h3>
                <table id="featuresTable">
                  <tr>
                    <th>Feature</th>
                    <th>Value</th>
                    <th>Normal Range</th>
                    <th>Status</th>
                  </tr>
                </table>
                
                <button class="mt-3" id="runPredictionFromFeatures">Run Prediction with These Features</button>
              </div>
            </div>
            
            <!-- Comparative Analysis Tab -->
            <div id="comparisonTab" class="tab-content">
              <div class="chart-container">
                <canvas id="comparisonChart"></canvas>
              </div>
              
              <div class="mt-4">
                <h3>Feature Comparison</h3>
                <p>This radar chart compares the patient's voice features against typical values for Parkinson's patients and healthy individuals.</p>
                
                <div class="flex gap-4 mt-3">
                  <div style="flex: 1;">
                    <h4>Key Observations</h4>
                    <ul id="keyObservations"></ul>
                  </div>
                  <div style="flex: 1;">
                    <h4>Recommendations</h4>
                    <ul id="recommendations"></ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Prediction History -->
          <div class="card" id="historySection">
            <div class="card-header">
              <div class="card-title"><i class="fas fa-history"></i> Prediction History</div>
              <div class="flex gap-4">
                <select id="resultFilter">
                  <option>All Results</option>
                  <option>Positive Only</option>
                  <option>Negative Only</option>
                </select>
                <select id="timeFilter">
                  <option>Last 30 Days</option>
                  <option>Last 6 Months</option>
                  <option>Last Year</option>
                  <option>All Time</option>
                </select>
                <input type="text" id="searchName" placeholder="Search by name...">
              </div>
            </div>
            
            <table id="historyTable">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Patient</th>
                  <th>Age</th>
                  <th>Location</th>
                  <th>Result</th>
                  <th>Confidence</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="historyBody">
              </tbody>
            </table>
            
            <div class="flex justify-between mt-3">
              <div id="paginationInfo">Showing 1-4 of 1248 predictions</div>
              <div class="flex gap-2">
                <button id="prevPage" style="padding: 5px 10px;">Previous</button>
                <button id="nextPage" style="padding: 5px 10px;">Next</button>
              </div>
            </div>
          </div>
          
          <!-- Analytics Dashboard -->
          <div class="card" id="analyticsSection">
            <div class="card-header">
              <div class="card-title"><i class="fas fa-chart-pie"></i> Analytics Dashboard</div>
              <select id="analyticsTimeFilter">
                <option>Last 30 Days</option>
                <option>Last 6 Months</option>
                <option>Last Year</option>
                <option>All Time</option>
              </select>
            </div>
            
            <div class="flex gap-4 mb-4">
              <div style="flex: 1;">
                <div class="chart-container">
                  <canvas id="resultPieChart"></canvas>
                </div>
              </div>
              <div style="flex: 1;">
                <div class="chart-container">
                  <canvas id="ageDistributionChart"></canvas>
                </div>
              </div>
            </div>
            
            <div class="chart-container">
              <canvas id="monthlyTrendsChart"></canvas>
            </div>
          </div>
        </div>

        <!-- Additional Sections -->
        <div id="globalDataSection" style="display: none;">
          <h1>Global Data</h1>
          <div class="card">
            <h3>Global Parkinson's Statistics</h3>
            <p>View worldwide data here (placeholder).</p>
          </div>
        </div>

        <div id="settingsSection" style="display: none;">
          <h1>Settings</h1>
          <div class="card">
            <h3>System Settings</h3>
            <p>Adjust preferences here (placeholder).</p>
          </div>
        </div>

        <div id="voiceAnalysisSection" style="display: none;">
          <h1>Voice Analysis</h1>
          <div class="card">
            <p>Redirecting to Voice Analysis tab...</p>
          </div>
        </div>

        <div id="riskAssessmentSection" style="display: none;">
          <h1>Risk Assessment</h1>
          <div class="card">
            <p>View risk assessment charts here (placeholder).</p>
          </div>
        </div>

        <div id="patientsSection" style="display: none;">
          <h1>Patients</h1>
          <div class="card">
            <p>Patient management interface (placeholder).</p>
          </div>
        </div>

        <div id="reportsSection" style="display: none;">
          <h1>Reports</h1>
          <div class="card">
            <p>Generate and view reports here (placeholder).</p>
          </div>
        </div>

        <div id="aboutParkinsonSection">
          <h1>About Parkinson's Disease</h1>
          <div class="card">
            <h3>What is Parkinson's?</h3>
            <p>Parkinson's disease is a progressive neurological disorder that affects movement, causing tremors, stiffness, and difficulty with balance and coordination. It occurs due to the loss of dopamine-producing neurons in the brain.</p>
            <h3>Symptoms</h3>
            <ul>
              <li>Tremors or shaking</li>
              <li>Slowed movement (bradykinesia)</li>
              <li>Muscle stiffness</li>
              <li>Impaired balance</li>
              <li>Changes in speech</li>
            </ul>
            <h3>Purpose of This System</h3>
            <p>This system uses voice analysis to detect early signs of Parkinson's by analyzing vocal features such as jitter, shimmer, and harmonics-to-noise ratio.</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Simulated database for prediction history
    let predictionHistory = [
      { date: "2023-05-15", patient: "John Smith", age: 65, location: "USA", result: "Positive", confidence: 87, features: { fo: 148.5, jitter: 0.72, shimmer: 0.35, nhr: 0.15, hnr: 16.8, ppe: 0.52 } },
      { date: "2023-05-14", patient: "Maria Garcia", age: 58, location: "Spain", result: "Negative", confidence: 92, features: { fo: 142.1, jitter: 0.42, shimmer: 0.22, nhr: 0.08, hnr: 22.3, ppe: 0.28 } },
      { date: "2023-05-12", patient: "Robert Johnson", age: 72, location: "UK", result: "Positive", confidence: 78, features: { fo: 145.2, jitter: 0.68, shimmer: 0.32, nhr: 0.12, hnr: 18.4, ppe: 0.45 } },
      { date: "2023-05-10", patient: "Sarah Chen", age: 61, location: "Canada", result: "Negative", confidence: 95, features: { fo: 140.0, jitter: 0.38, shimmer: 0.20, nhr: 0.07, hnr: 23.5, ppe: 0.25 } }
    ];
    let currentPage = 1;
    const itemsPerPage = 4;

    // Initialize Leaflet Map
    const map = L.map('diseaseMap').setView([20, 0], 2);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);
    
    const countries = [
      {name: "USA", lat: 37.8, lng: -96, cases: 125, severity: 0.7},
      {name: "UK", lat: 55.4, lng: -3.4, cases: 87, severity: 0.6},
      {name: "Japan", lat: 36.2, lng: 138.3, cases: 92, severity: 0.5},
      {name: "Brazil", lat: -14.2, lng: -51.9, cases: 45, severity: 0.4},
      {name: "Australia", lat: -25.3, lng: 133.8, cases: 38, severity: 0.3}
    ];
    
    countries.forEach(country => {
      const radius = Math.sqrt(country.cases) * 3;
      const color = `hsl(${30 + country.severity * 60}, 100%, 50%)`;
      L.circleMarker([country.lat, country.lng], {
        radius: radius,
        fillColor: color,
        color: "#000",
        weight: 1,
        opacity: 1,
        fillOpacity: 0.8
      }).addTo(map)
        .bindPopup(`<b>${country.name}</b><br>Cases: ${country.cases} per 100k`);
    });
    
    // Initialize Charts
    const ageRiskCtx = document.getElementById('ageRiskChart').getContext('2d');
    let ageRiskChart = new Chart(ageRiskCtx, {
      type: 'bar',
      data: {
        labels: ['40-49', '50-59', '60-69', '70-79', '80+'],
        datasets: [{
          label: 'Parkinson\'s Prevalence',
          data: [5, 15, 35, 55, 65],
          backgroundColor: 'rgba(106, 17, 203, 0.7)',
          borderColor: 'rgba(106, 17, 203, 1)',
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: { beginAtZero: true, title: { display: true, text: 'Cases per 1000 people' } },
          x: { title: { display: true, text: 'Age Group' } }
        }
      }
    });
    
    const resultPieCtx = document.getElementById('resultPieChart').getContext('2d');
    let resultPieChart = new Chart(resultPieCtx, {
      type: 'pie',
      data: {
        labels: ['Positive', 'Negative'],
        datasets: [{
          data: [312, 936],
          backgroundColor: ['#ff4c4c', '#4caf50'],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { position: 'bottom' },
          tooltip: {
            callbacks: {
              label: function(context) {
                const label = context.label || '';
                const value = context.raw || 0;
                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                const percentage = Math.round((value / total) * 100);
                return `${label}: ${value} (${percentage}%)`;
              }
            }
          }
        }
      }
    });
    
    const ageDistCtx = document.getElementById('ageDistributionChart').getContext('2d');
    let ageDistChart = new Chart(ageDistCtx, {
      type: 'line',
      data: {
        labels: ['40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75-79', '80+'],
        datasets: [{
          label: 'Positive Cases',
          data: [5, 12, 28, 45, 62, 75, 58, 42, 35],
          borderColor: '#ff4c4c',
          backgroundColor: 'rgba(255, 76, 76, 0.1)',
          fill: true,
          tension: 0.3
        }, {
          label: 'Negative Cases',
          data: [25, 38, 52, 65, 58, 45, 32, 25, 18],
          borderColor: '#4caf50',
          backgroundColor: 'rgba(76, 175, 80, 0.1)',
          fill: true,
          tension: 0.3
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: { beginAtZero: true, title: { display: true, text: 'Number of Cases' } },
          x: { title: { display: true, text: 'Age Group' } }
        }
      }
    });
    
    const monthlyTrendsCtx = document.getElementById('monthlyTrendsChart').getContext('2d');
    let monthlyTrendsChart = new Chart(monthlyTrendsCtx, {
      type: 'bar',
      data: {
        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
        datasets: [{
          label: 'Positive Predictions',
          data: [12, 18, 22, 15, 28, 24, 19, 25, 30, 22, 18, 14],
          backgroundColor: 'rgba(255, 76, 76, 0.7)',
          borderColor: 'rgba(255, 76, 76, 1)',
          borderWidth: 1
        }, {
          label: 'Total Predictions',
          data: [45, 52, 60, 48, 65, 58, 50, 62, 75, 68, 55, 48],
          backgroundColor: 'rgba(37, 117, 252, 0.7)',
          borderColor: 'rgba(37, 117, 252, 1)',
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: { beginAtZero: true, title: { display: true, text: 'Number of Predictions' } },
          x: { title: { display: true, text: 'Month' } }
        }
      }
    });
    
    let comparisonChart;
    function updateComparisonChart(features) {
      const comparisonCtx = document.getElementById('comparisonChart').getContext('2d');
      if (comparisonChart) comparisonChart.destroy();
      comparisonChart = new Chart(comparisonCtx, {
        type: 'radar',
        data: {
          labels: ['Fo (Hz)', 'Jitter (%)', 'Shimmer (dB)', 'NHR', 'HNR', 'PPE'],
          datasets: [{
            label: 'Current Patient',
            data: [features.fo, features.jitter, features.shimmer, features.nhr, features.hnr, features.ppe],
            backgroundColor: 'rgba(106, 17, 203, 0.2)',
            borderColor: 'rgba(106, 17, 203, 1)',
            borderWidth: 2,
            pointBackgroundColor: 'rgba(106, 17, 203, 1)'
          }, {
            label: 'Parkinson\'s Average',
            data: [148.5, 0.72, 0.35, 0.15, 16.8, 0.52],
            backgroundColor: 'rgba(255, 76, 76, 0.2)',
            borderColor: 'rgba(255, 76, 76, 1)',
            borderWidth: 2,
            pointBackgroundColor: 'rgba(255, 76, 76, 1)'
          }, {
            label: 'Healthy Average',
            data: [142.1, 0.42, 0.22, 0.08, 22.3, 0.28],
            backgroundColor: 'rgba(76, 175, 80, 0.2)',
            borderColor: 'rgba(76, 175, 80, 1)',
            borderWidth: 2,
            pointBackgroundColor: 'rgba(76, 175, 80, 1)'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            r: { angleLines: { display: true }, suggestedMin: 0 }
          }
        }
      });
    }
    
    // Tab Switching
    function switchTab(tabName) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.getElementById(`${tabName}Tab`).classList.add('active');
      const tabButtons = document.querySelectorAll('.tab');
      for (let i = 0; i < tabButtons.length; i++) {
        if (tabButtons[i].textContent.toLowerCase().includes(tabName)) {
          tabButtons[i].classList.add('active');
          break;
        }
      }
    }
    
    // Section Switching
    function switchSection(sectionName) {
      document.querySelectorAll('.main-content > div').forEach(section => section.style.display = 'none');
      document.querySelectorAll('.nav-links a, .sidebar-menu a').forEach(link => link.classList.remove('active'));
      document.getElementById(`${sectionName}Section`).style.display = 'block';
      
      const navLink = document.querySelector(`.nav-links a[data-section="${sectionName}"]`);
      const sidebarLink = document.querySelector(`.sidebar-menu a[data-section="${sectionName}"]`);
      if (navLink) navLink.classList.add('active');
      if (sidebarLink) sidebarLink.classList.add('active');

      if (sectionName === 'voiceAnalysis') {
        switchTab('voiceAnalysis');
        document.getElementById('dashboardSection').style.display = 'block';
      }
    }
    
    // Navigation and Sidebar Buttons
    document.querySelectorAll('.nav-links a, .sidebar-menu a').forEach(link => {
      link.addEventListener('click', function() {
        const section = this.getAttribute('data-section');
        switchSection(section);
      });
    });
    
    // Auth Buttons
    document.querySelector('.login-btn').addEventListener('click', () => {
      alert('Login functionality coming soon! Please enter your credentials in a future update.');
    });
    
    document.querySelector('.signup-btn').addEventListener('click', () => {
      alert('Sign up functionality coming soon! Register to access advanced features in a future update.');
    });
    
    // Audio Recorder
    const recordBtn = document.querySelector('.record-btn');
    const stopBtn = document.querySelector('.stop-btn');
    const uploadBtn = document.querySelector('.upload-btn');
    let isRecording = false;
    
    recordBtn.addEventListener('click', function() {
      if (!isRecording) {
        this.innerHTML = '<i class="fas fa-circle"></i>';
        this.style.backgroundColor = '#ff4c4c';
        stopBtn.disabled = false;
        isRecording = true;
        console.log("Recording started...");
      }
    });
    
    stopBtn.addEventListener('click', function() {
      if (isRecording) {
        recordBtn.innerHTML = '<i class="fas fa-microphone"></i>';
        recordBtn.style.backgroundColor = 'var(--danger)';
        this.disabled = true;
        isRecording = false;
        console.log("Recording stopped.");
        const features = simulateVoiceAnalysis();
        displayExtractedFeatures(features);
      }
    });
    
    uploadBtn.addEventListener('click', function() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.wav';
      input.onchange = (e) => {
        console.log("File uploaded:", e.target.files[0].name);
        const features = simulateVoiceAnalysis();
        displayExtractedFeatures(features);
      };
      input.click();
    });
    
    function simulateVoiceAnalysis() {
      return {
        fo: (Math.random() * 60 + 120).toFixed(2),
        jitter: (Math.random() * 0.5 + 0.3).toFixed(2),
        shimmer: (Math.random() * 0.2 + 0.2).toFixed(2),
        nhr: (Math.random() * 0.1 + 0.05).toFixed(2),
        hnr: (Math.random() * 10 + 15).toFixed(2),
        ppe: (Math.random() * 0.3 + 0.2).toFixed(2)
      };
    }
    
    function displayExtractedFeatures(features) {
      const table = document.getElementById('featuresTable');
      table.innerHTML = `
        <tr><th>Feature</th><th>Value</th><th>Normal Range</th><th>Status</th></tr>
        <tr><td>MDVP: Fo (Hz)</td><td>${features.fo}</td><td>120-180</td><td>${features.fo >= 120 && features.fo <= 180 ? '<span class="text-success">Normal</span>' : '<span class="text-danger">Abnormal</span>'}</td></tr>
        <tr><td>Jitter (%)</td><td>${features.jitter}</td><td>< 0.5</td><td>${features.jitter < 0.5 ? '<span class="text-success">Normal</span>' : '<span class="text-danger">High</span>'}</td></tr>
        <tr><td>Shimmer (dB)</td><td>${features.shimmer}</td><td>< 0.3</td><td>${features.shimmer < 0.3 ? '<span class="text-success">Normal</span>' : '<span class="text-danger">High</span>'}</td></tr>
        <tr><td>NHR</td><td>${features.nhr}</td><td>< 0.1</td><td>${features.nhr < 0.1 ? '<span class="text-success">Normal</span>' : '<span class="text-danger">High</span>'}</td></tr>
        <tr><td>HNR</td><td>${features.hnr}</td><td>> 20</td><td>${features.hnr > 20 ? '<span class="text-success">Normal</span>' : '<span class="text-danger">Low</span>'}</td></tr>
        <tr><td>PPE</td><td>${features.ppe}</td><td>< 0.4</td><td>${features.ppe < 0.4 ? '<span class="text-success">Normal</span>' : '<span class="text-danger">High</span>'}</td></tr>
      `;
      document.getElementById('extractedFeatures').style.display = 'block';
      document.getElementById('runPredictionFromFeatures').onclick = () => runPrediction(features);
    }
    
    // Prediction Form
    document.getElementById('predictionForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const features = {
        fo: parseFloat(document.getElementById('fo').value),
        jitter: parseFloat(document.getElementById('jitter').value),
        shimmer: parseFloat(document.getElementById('shimmer').value),
        nhr: parseFloat(document.getElementById('nhr').value),
        hnr: parseFloat(document.getElementById('hnr').value),
        ppe: parseFloat(document.getElementById('ppe').value)
      };
      const patientData = {
        patient: document.getElementById('patientName').value,
        age: parseInt(document.getElementById('patientAge').value),
        location: document.getElementById('patientLocation').value,
        features: features
      };
      runPrediction(features, patientData);
      this.reset();
    });
    
    function runPrediction(features, patientData = null) {
      const score = (features.jitter > 0.5 ? 20 : 0) +
                    (features.shimmer > 0.3 ? 20 : 0) +
                    (features.nhr > 0.1 ? 20 : 0) +
                    (features.hnr < 20 ? 20 : 0) +
                    (features.ppe > 0.4 ? 20 : 0);
      const confidence = Math.min(95, 60 + score * 0.7);
      const result = score > 50 ? "Positive" : "Negative";
      
      if (patientData) {
        const today = new Date().toISOString().split('T')[0];
        predictionHistory.unshift({
          date: today,
          patient: patientData.patient,
          age: patientData.age,
          location: patientData.location,
          result: result,
          confidence: confidence,
          features: features
        });
        updateHistoryTable();
        document.getElementById('predictionResult').innerHTML = `
          <h3>Prediction Result</h3>
          <p>Result: <span class="${result === 'Positive' ? 'text-danger' : 'text-success'}">${result}</span></p>
          <p>Confidence: ${confidence.toFixed(0)}%</p>
        `;
        document.getElementById('predictionResult').style.display = 'block';
      }
      
      updateComparisonChart(features);
      updateComparativeAnalysis(features, result, confidence);
      switchTab('comparison');
    }
    
    function updateComparativeAnalysis(features, result, confidence) {
      const observations = [];
      const recommendations = [];
      
      if (features.jitter > 0.5) observations.push("Higher than normal jitter");
      if (features.shimmer > 0.3) observations.push("Elevated shimmer levels");
      if (features.nhr > 0.1) observations.push("Elevated noise-to-harmonics ratio (NHR)");
      if (features.hnr < 20) observations.push("Reduced harmonics-to-noise ratio (HNR)");
      if (features.ppe > 0.4) observations.push("High pitch period entropy (PPE)");
      if (observations.length === 0) observations.push("All features within normal range");
      
      if (result === "Positive") {
        recommendations.push("Consult a neurologist for further evaluation");
        recommendations.push("Consider speech therapy exercises");
        recommendations.push("Schedule follow-up voice analysis in 3 months");
      } else {
        recommendations.push("Maintain regular health check-ups");
        recommendations.push("Monitor for any changes in voice or motor skills");
      }
      
      document.getElementById('keyObservations').innerHTML = observations.map(obs => `<li>${obs}</li>`).join('');
      document.getElementById('recommendations').innerHTML = recommendations.map(rec => `<li>${rec}</li>`).join('');
    }
    
    // History Table
    function updateHistoryTable() {
      const tbody = document.getElementById('historyBody');
      const resultFilter = document.getElementById('resultFilter').value;
      const searchName = document.getElementById('searchName').value.toLowerCase();
      
      let filteredHistory = predictionHistory.filter(item => {
        const matchesResult = resultFilter === "All Results" || item.result === resultFilter.split(' ')[0];
        const matchesName = item.patient.toLowerCase().includes(searchName);
        return matchesResult && matchesName;
      });
      
      const start = (currentPage - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const paginatedHistory = filteredHistory.slice(start, end);
      
      tbody.innerHTML = paginatedHistory.map((item, index) => `
        <tr>
          <td>${item.date}</td>
          <td>${item.patient}</td>
          <td>${item.age}</td>
          <td>${item.location}</td>
          <td><span class="${item.result === 'Positive' ? 'text-danger' : 'text-success'}">${item.result}</span></td>
          <td>${item.confidence}%</td>
          <td>
            <button onclick="viewPrediction(${start + index})" style="padding: 5px 10px; font-size: 12px;">View</button>
            <button onclick="exportPrediction(${start + index})" style="padding: 5px 10px; font-size: 12px;">Export</button>
          </td>
        </tr>
      `).join('');
      
      document.getElementById('paginationInfo').textContent = `Showing ${start + 1}-${Math.min(end, filteredHistory.length)} of ${filteredHistory.length} predictions`;
      document.getElementById('prevPage').disabled = currentPage === 1;
      document.getElementById('nextPage').disabled = end >= filteredHistory.length;
    }
    
    function viewPrediction(index) {
      const item = predictionHistory[index];
      updateComparisonChart(item.features);
      updateComparativeAnalysis(item.features, item.result, item.confidence);
      switchTab('comparison');
      switchSection('dashboard');
    }
    
    function exportPrediction(index) {
      const item = predictionHistory[index];
      const csv = `Date,Patient,Age,Location,Result,Confidence,Fo,Jitter,Shimmer,NHR,HNR,PPE\n${item.date},${item.patient},${item.age},${item.location},${item.result},${item.confidence},${item.features.fo},${item.features.jitter},${item.features.shimmer},${item.features.nhr},${item.features.hnr},${item.features.ppe}`;
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${item.patient}_prediction.csv`;
      a.click();
      URL.revokeObjectURL(url);
    }
    
    document.getElementById('prevPage').addEventListener('click', () => {
      if (currentPage > 1) {
        currentPage--;
        updateHistoryTable();
      }
    });
    
    document.getElementById('nextPage').addEventListener('click', () => {
      currentPage++;
      updateHistoryTable();
    });
    
    document.getElementById('resultFilter').addEventListener('change', () => {
      currentPage = 1;
      updateHistoryTable();
    });
    
    document.getElementById('searchName').addEventListener('input', () => {
      currentPage = 1;
      updateHistoryTable();
    });
    
    // Filter Buttons
    document.getElementById('mapTimeFilter').addEventListener('change', function() {
      alert(`Filtering map data for: ${this.value}`);
      // In a real app, update map markers here
    });
    
    document.getElementById('ageRiskFilter').addEventListener('change', function() {
      const filter = this.value;
      let newData;
      if (filter === 'Positive Cases') newData = [3, 10, 25, 40, 50];
      else if (filter === 'Negative Cases') newData = [2, 5, 10, 15, 15];
      else newData = [5, 15, 35, 55, 65];
      ageRiskChart.data.datasets[0].data = newData;
      ageRiskChart.update();
    });
    
    document.getElementById('analyticsTimeFilter').addEventListener('change', function() {
      alert(`Filtering analytics data for: ${this.value}`);
      // In a real app, update charts here
    });
    
    // Initial setup
    updateHistoryTable();
    updateComparisonChart(predictionHistory[0].features);
    switchSection('dashboard');
  </script>
</body>
</html>